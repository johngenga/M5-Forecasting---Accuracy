Here is a description of the logic used while developing the tool.